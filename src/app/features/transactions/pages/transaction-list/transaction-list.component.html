<div class="card-container">
  <p-toast />

  <div class="table-header">
    <h2 class="page-title">Transaction Management</h2>
    <p-button label="New Transaction" icon="pi pi-plus" (onClick)="showDialog()"></p-button>
  </div>

  <p-table [value]="transactions()" class="p-datatable-striped" [scrollable]="true">
    <ng-template pTemplate="header">
      <tr>
        <th>Date</th>
        <th>Description</th>
        <th>Category</th>
        <th>Type</th>
        <th>Amount</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-transaction>
      <tr>
        <td>{{ transaction.date | date: 'MM/dd/yyyy' }}</td>
        <td>{{ transaction.description }}</td>
        <td>
          <span [style.color]="transaction.category.color" class="category-indicator">
            ‚óè {{ transaction.category.name }}
          </span>
        </td>
        <td>
          <span [class]="'type-badge ' + transaction.type.toLowerCase()">
            {{ transaction.type }}
          </span>
        </td>
        <td class="amount-cell">
          {{ transaction.amount | currency: 'USD' : 'symbol' : '1.2-2' }}
        </td>
      </tr>
    </ng-template>
  </p-table>

  <p-dialog header="New Transaction" [(visible)]="displayDialog" [modal]="true" styleClass="transaction-dialog">

    <form [formGroup]="transactionForm" class="transaction-form">

      <div class="form-field">
        <label for="description">Description</label>
        <input pInputText id="description" formControlName="description" />
      </div>

      <div class="form-field">
        <label for="amount">Amount</label>
        <p-inputNumber id="amount" formControlName="amount" mode="currency" currency="USD" locale="en-US"
          placeholder="$ 0.00" />
      </div>

      <div class="form-field">
        <label for="date">Date</label>
        <p-datepicker id="date" formControlName="date" dateFormat="mm/dd/yy" [showIcon]="true" appendTo="body" />
      </div>

      <div class="form-field">
        <label for="category">Category</label>
        <p-select [options]="categories()" formControlName="category" optionLabel="name" placeholder="Select a Category"
          appendTo="body" />
      </div>

      <div class="form-field">
        <label for="type">Type</label>
        <p-select [options]="['INCOME', 'EXPENSE']" formControlName="type" placeholder="Select Type" appendTo="body" />
      </div>

    </form>

    <ng-template pTemplate="footer">
      <p-button label="Cancel" [text]="true" severity="secondary" (onClick)="displayDialog.set(false)" />
      <p-button label="Save" icon="pi pi-check" (onClick)="saveTransaction()" />
    </ng-template>
  </p-dialog>
</div>